<!DOCTYPE html>
<html>
<head>
<title>Your Profile</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<style>
body {
    font-family: Arial;
    background: #9ec165ff;
    padding: 15px;
}

.profile-card {
    background: white;
    padding: 15px;
    border-radius: 12px;
    box-shadow: 0px 2px 6px rgba(93, 78, 195, 1);
}

.row {
    margin: 6px 0;
}

.btn {
    margin-top: 10px;
    padding: 8px 12px;
    border: none;
    border-radius: 6px;
}

.logout {
    background: red;
    color: white;
}

.edit {
    background: blue;
    color: white;
}
</style>

</head>

<body>

<h2>Your Profile</h2>

<div class="profile-card">

    <div class="row"><b>Email:</b> <span id="email"></span></div>
    <div class="row"><b>Username:</b> <span id="username"></span></div>
    <div class="row"><b>Name:</b> <span id="name"></span></div>
    <div class="row"><b>Department:</b> <span id="department"></span></div>
    <div class="row"><b>Degree:</b> <span id="degree"></span></div>
    <div class="row"><b>Year:</b> <span id="year"></span></div>
    <div class="row"><b>Gender:</b> <span id="gender"></span></div>
    <div class="row"><b>Bio:</b> <span id="bio"></span></div>
    <div class="row"><b>Interests:</b> <span id="interest"></span></div>

</div>

<br>

<button class="btn edit" onclick="goUpdate()">Edit Profile</button>
<button class="btn" onclick="goDashboard()">Dashboard</button>
<button class="btn logout" onclick="logout()">Logout</button>

<script>

const email = localStorage.getItem("userEmail");

if (!email){
    alert("Not logged in");
    window.location.href = "/";
}

async function loadProfile(){

    const response = await fetch("http://10.3.146.91:8000/api/get-profile",{
        method:"POST",
        headers:{
            "Content-Type":"application/json"
        },
        body: JSON.stringify({ email: email })
    });

    const data = await response.json();

    if (!response.ok){
        window.location.href = "/setup";
        return;
    }

    document.getElementById("email").innerText = data.email;
    document.getElementById("username").innerText = data.username;
    document.getElementById("name").innerText = data.name;
    document.getElementById("department").innerText = data.department;
    document.getElementById("degree").innerText = data.degree;
    document.getElementById("year").innerText = data.year;
    document.getElementById("gender").innerText = data.gender;
    document.getElementById("bio").innerText = data.bio;
    document.getElementById("interest").innerText = data.interest;
}

loadProfile();


function logout(){
    localStorage.removeItem("userEmail");
    window.location.href = "/";
}

function goDashboard(){
    window.location.href = "/dashboard";
}

function goUpdate(){
    window.location.href = "/update";
}

</script>

</body>
</html>